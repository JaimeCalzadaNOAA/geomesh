What we actually need is a concurrency manager. That is, a Python class that we can configure with the slurm account settings, and to which we can do "add_job(func, id='some_id', depends_on='some_other_id')", and then we can do manager.run(wait=True).